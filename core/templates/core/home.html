{% extends 'core/base.html' %}
{% load static %}

{% block content %}

{% if request.user.is_authenticated %}
<div class="container text-center">
    <div class="row">
        <div class="col-8">


            {% for post in posts %}
            {% if request.user.id != post.user.id %}


            <div class="alert alert-primary" role="alert">
                <div class="container">
                    <div class="row">
                        <div class="col-1">
                            {% if post.user.profile.profile_image %}
                            <img src="{{ post.user.profile.profile_image.url }}"
                                 alt="{{ post.user.profile.user.username }}"
                                 width="50" height="50" class="rounded-circle">
                            {% else %}
                            <img src="{% static 'images/default_avatar.png' %}" alt="{{ profile.user.username }}"
                                 width="50" height="50">
                            {% endif %}
                        </div>
                        <div class="col-10">

                            <a href="{% url 'post_show' post.id %}" style="color: inherit;text-decoration: none;">
                                {{ post.body }}</a><br>
                            <small class="text-muted">
                                {{ post.created_at }} By
                                <a href="{% url 'profile' post.user.id %}">@{{ post.user.username }}</a>
                                - {{ post.count_likes }}
                                {% if post.count_likes == 1 %}
                                like
                                {% else %}
                                likes
                                {% endif %}

                                {% if user in post.likes.all %}
                                &nbsp;<a href="{% url 'post_like' post.id %}"><i class="fa-solid fa-heart"
                                                                                 style="color: #ff0000;"></i></a>
                                {% else %}
                                &nbsp;<a href="{% url 'post_like' post.id %}"><i class="fa-regular fa-heart"
                                                                                 style="color: #ff0000;"></i></a>
                                {% endif %}
                                &nbsp;&nbsp;
                                {{ post.comment_count }}
                                {% if post.comment_count == 1 %}
                                 comment
                                {% else %}
                                comments
                                {% endif %}
                                &nbsp;<a href="{% url 'post_show' post.id %}"><i class="fa-duotone fa-solid fa-comment"></i></a>
                            </small>
                        </div>
                    </div>
                </div>
            </div>

            {% endif %}
            {% endfor %}
        </div>


        <div class="col-4">
            {% if form %}
            <form method="post">
                {% csrf_token %}

                {{ form.as_p }}


                <button type="submit" class="btn btn-dark">Create a post</button>
            </form>
            {% endif %}

        </div>
    </div>
</div>

{% else %}


{% for post in posts %}
{% if request.user.id != post.user.id %}


<div class="alert alert-primary text-center mx-auto" style="max-width: 720px;" role="alert">
    <div class="container">
        <div class="row">
            <div class="col-1">
                {% if post.user.profile.profile_image %}
                <img src="{{ post.user.profile.profile_image.url }}"
                     alt="{{ post.user.profile.user.username }}"
                     width="50" height="50" class="rounded-circle">
                {% else %}
                <img src="{% static 'images/default_avatar.png' %}" alt="{{ profile.user.username }}"
                     width="50" height="50">
                {% endif %}
            </div>
            <div class="col-10">

                <a href="{% url 'post_show' post.id %}" style="color: inherit;text-decoration: none;">
                    {{ post.body }}</a><br>
                <small class="text-muted">
                    {{ post.created_at }} By
                    <a href="{% url 'profile' post.user.id %}">@{{ post.user.username }}</a>
                    - {{ post.count_likes }} likes
                    {% if user in post.likes.all %}
                    &nbsp;<a href="{% url 'post_like' post.id %}"><i class="fa-solid fa-heart"
                                                                     style="color: #ff0000;"></i></a>
                    {% else %}
                    &nbsp;<a href="{% url 'post_like' post.id %}"><i class="fa-regular fa-heart"
                                                                     style="color: #ff0000;"></i></a>
                    {% endif %}
                </small>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endfor %}
{% endif %}
{% endblock %}
